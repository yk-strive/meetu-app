(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/home/index"],{"1d09":function(e,t,n){"use strict";n.r(t);var a=n("35e7"),o=n("98e3");for(var i in o)"default"!==i&&function(e){n.d(t,e,function(){return o[e]})}(i);n("392e");var r=n("2877"),s=Object(r["a"])(o["default"],a["a"],a["b"],!1,null,null,null);t["default"]=s.exports},"35e7":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement;e._self._c},o=[];n.d(t,"a",function(){return a}),n.d(t,"b",function(){return o})},"38c3":function(e,t,n){"use strict";(function(e){n("e1e3"),n("921b");a(n("66fd"));var t=a(n("1d09"));function a(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("6e42")["createPage"])},"392e":function(e,t,n){"use strict";var a=n("65f2"),o=n.n(a);o.a},"65f2":function(e,t,n){},"98e3":function(e,t,n){"use strict";n.r(t);var a=n("d9c2"),o=n.n(a);for(var i in a)"default"!==i&&function(e){n.d(t,e,function(){return a[e]})}(i);t["default"]=o.a},d9c2:function(e,t,n){"use strict";(function(e,a){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=u(n("a34a")),i=n("2f62"),r=u(n("c478")),s=u(n("8a5c")),c=n("db78");u(n("7687"));function u(e){return e&&e.__esModule?e:{default:e}}function l(e,t,n,a,o,i,r){try{var s=e[i](r),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(a,o)}function d(e){return function(){var t=this,n=arguments;return new Promise(function(a,o){var i=e.apply(t,n);function r(e){l(i,a,o,r,s,"next",e)}function s(e){l(i,a,o,r,s,"throw",e)}r(void 0)})}}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){h(e,t,n[t])})}return e}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m={name:"homeIndex",components:{},mixins:[r.default],data:function(){return{isSendSignal:!1,showDailyLogin:!1,appName:"Meet U",showSendToast:!1,userNumber:null}},computed:f({},(0,i.mapGetters)(["userInfo","dailyLogin","token"]),(0,i.mapState)({unread:function(e){return e.socketInfo.unread}})),onLoad:function(t){this.api_UserNumber(),e.removeStorageSync("searchInfo")},onReady:function(){this.ws_init(),e.getStorageSync("homeSendToast")?this.showSendToast=!1:this.showSendToast=!0},onShow:function(){var t=this;if(this.api_UserInfo(),getApp().globalData.sendSignal&&(this.isSendSignal=!0,this.api_UserNumber(),setTimeout(function(){getApp().globalData.sendSignal=!1,t.isSendSignal=!1},4e3)),1==this.dailyLogin)return!1;if(e.getStorageSync("dailyLoginExpires")){var n=(new Date).getTime();n>e.getStorageSync("dailyLoginExpires")?(this.clog("mow","超过"),this.showDailyLogin=!0):(this.clog("mow","未超过"),this.showDailyLogin=!1)}else this.showDailyLogin=!0},methods:{ws_init:function(){var e=this,t=new s.default({url:"wss://api.meetu.letwx.com/im?token="+e.token,timeout:3e4,isSendHeart:!0,heartData:{msgType:"ping",data:{}},isReconnection:!0,reConnectTime:3e3,debug:!1,params:{},onSocketOpen:function(e){},onSocketMessage:function(t){e.$store.dispatch("setSocketState",t)},onSocketError:function(t){e.$store.dispatch("setSocketStateErr",t)},onSocketClose:function(e){}});console.log(a("--socket--",t," at pages\\home\\index.vue:176")),e.$store.dispatch("WS",t),t.initSocket()},api_UserInfo:function(){var e=d(o.default.mark(function e(){var t;return o.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$http1.post("user/info");case 2:t=e.sent,0==t.code?this.$store.dispatch("changeVal",{stateKey:"userInfo",newValue:t.data}):this.modelShow("toastModal",t.msg);case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),api_UserNumber:function(){var e=this;this.$http1.post("user/number").then(function(t){e.userNumber=t.data}).catch(function(e){})},api_DailyLogin:function(){var t=this,n=this;this.$http1.post("points/daily-login").then(function(a){0==a.code&&(t.modalShow("toastModal","领取成功"),t.showDailyLogin=!1,e.setStorageSync("dailyLoginExpires",n.expiresTime()))}).catch(function(e){t.showDailyLogin=!1,t.modalShow("toastModal",e.data.msg)})},getDailyLogin:function(){this.api_DailyLogin()},linkUser:function(){e.navigateTo({url:"../user/index",animationDuration:300,animationType:"fade-in"})},linkAction:function(t){switch(t){case"search":e.navigateTo({url:"../search/search",animationDuration:500,animationType:"fade-in"});break;case"send":e.getStorageSync("homeSendToast")||(e.setStorageSync("homeSendToast",!0),this.showSendToast=!1),this.modalName="bottomModal";break;case"chatList":e.navigateTo({url:"../chat/list",animationDuration:500,animationType:"fade-in"});break;case"sendText":this.modalName="",e.navigateTo({url:"../send/text",animationDuration:500,animationType:"fade-in"});break;case"sendVoice":this.modalName="",e.navigateTo({url:"../send/voice",animationDuration:500,animationType:"fade-in"});break}},expiresTime:function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1>9?e.getMonth()+1:"0"+e.getMonth()+1,a=e.getDate()>9?e.getDate():"0"+e.getDate(),o=t+"/"+n+"/"+a+" 23:59:59";return new Date(o).getTime()},hideModal:function(){this.modalName=""},copyHandle:(0,c.throttle)(function(){var t=this;e.setClipboardData({data:t.token,success:function(){}})},5e3)}};t.default=m}).call(this,n("6e42")["default"],n("0de9")["default"])}},[["38c3","common/runtime","common/vendor"]]]);