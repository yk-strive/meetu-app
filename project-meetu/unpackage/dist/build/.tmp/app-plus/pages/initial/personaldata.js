(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/initial/personaldata"],{"023e":function(e,t,i){"use strict";i.r(t);var n=i("c8ca"),a=i.n(n);for(var o in n)"default"!==o&&function(e){i.d(t,e,function(){return n[e]})}(o);t["default"]=a.a},"02cc":function(e,t,i){"use strict";var n=function(){var e=this,t=e.$createElement;e._self._c},a=[];i.d(t,"a",function(){return n}),i.d(t,"b",function(){return a})},"19ac":function(e,t,i){},5934:function(e,t,i){"use strict";var n=i("19ac"),a=i.n(n);a.a},c8ca:function(e,t,i){"use strict";(function(e,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(i("c478")),o=i("2f62");function r(e){return e&&e.__esModule?e:{default:e}}function s(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=Object.keys(i);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),n.forEach(function(t){c(e,t,i[t])})}return e}function c(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var l=function(){return Promise.all([i.e("common/vendor"),i.e("components/w-picker/w-picker")]).then(i.bind(null,"5222"))},u={name:"personaldata",components:{wPicker:l},mixins:[a.default],data:function(){return{isEditInfo:!1,userInfo:null,ischangeHeadimg:!1,selectList:[{label:"男",value:0},{label:"女",value:1}],mode:"date",defaultVal:[0,0,0,0,0,0,0],sex:"",pickerBirthdayInfo:{checkArr:["1990","01","01"],defaultVal:[],result:"选择生日"},pickerRegionInfo:{checkArr:["北京市","市辖区"],checkValue:["11","1101"],defaultVal:[],result:"选择地区"}}},computed:s({},(0,o.mapGetters)(["token"])),onLoad:function(e){this.isEditInfo=!(!e.type||"edit"!=e.type),this.api_UserInfo()},onReady:function(){},methods:s({},(0,o.mapMutations)(["changeVal"]),{api_UserInfo:function(){var t=this;this.$http1.post("user/info").then(function(i){console.log(e("------userinfo-----",i," at pages\\initial\\personaldata.vue:116")),t.userInfo=i.data,t.sex=1==i.data.sex?"男":"女",t.pickerBirthdayInfo.result=i.data.birthday?i.data.birthday:t.pickerBirthdayInfo.result,t.pickerRegionInfo.result=i.data.province&&i.data.city?i.data.province+""+i.data.city:t.pickerRegionInfo.result}).catch(function(t){console.log(e("userinfo-err",t," at pages\\initial\\personaldata.vue:122"))})},getUid:function(e){return e.substring(e.indexOf("/")+1,e.lastIndexOf("."))},chooseImage:function(){var t=this;n.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album"],success:function(i){var a=i.tempFilePaths[0];plus.zip.compressImage({src:a,dst:"_doc/"+t.getUid(a)+".jpg",overwrite:!0,quality:20},function(i){n.uploadFile({url:"https://api.meetu.letwx.com/v2/sys/upload-img?token="+t.token,filePath:i.target,name:"imgfile",formData:{name:"imgfile",formData:JSON.stringify({sort:0})},success:function(e){t.userInfo.headimgurl=JSON.parse(e.data).data.imgUrl,t.ischangeHeadimg=!0},fail:function(t){console.log(e("err",t," at pages\\initial\\personaldata.vue:159"))}})},function(t){console.log(e("plus-error",t," at pages\\initial\\personaldata.vue:164"))})}})},togglePicker:function(e){if("selector"==e&&1==this.userInfo.isedit)return this.modalShow("toastModal","性别只能修改一次, 你已修改过"),!1;this.mode=e,this.$refs[e].show()},onConfirm:function(t){switch(console.log(e(t," at pages\\initial\\personaldata.vue:179")),this.mode){case"date":this.pickerBirthdayInfo=t;break;case"selector":this.sex=t.result;break;case"region":this.pickerRegionInfo=t;break}},submitInfo:function(t){var i=this,a=this,o={};return""==t.detail.value.nickname?(this.modalShow("toastModal","昵称不能为空"),!1):"选择生日"===this.pickerBirthdayInfo.result?(this.modalShow("toastModal","请选择你的出生日期"),!1):"选择地区"==this.pickerRegionInfo.result?(this.modalShow("toastModal","请选择地区"),!1):null!=this.pickerRegionInfo.result.match(/\w/)?(this.modalShow("toastModal","请选择地区(中文)"),!1):(t.detail.value.nickname!=this.userInfo.nickname&&""!=t.detail.value.nickname&&(o.nickname=t.detail.value.nickname),t.detail.value.invitecode&&(o.code=t.detail.value.invitecode),this.sex!=(1==this.userInfo.sex?"男":"女")&&(o.sex="男"==this.sex?1:2),this.pickerBirthdayInfo.result!=this.userInfo.birthday&&(o.birthday=this.pickerBirthdayInfo.result),this.pickerRegionInfo.checkArr[0]!=this.userInfo.province&&(o.province=this.pickerRegionInfo.checkArr[0]),this.pickerRegionInfo.checkArr[1]!=this.userInfo.city&&(o.city=this.pickerRegionInfo.checkArr[1]),this.ischangeHeadimg&&(o.headimgurl=this.userInfo.headimgurl),console.log(e(o," at pages\\initial\\personaldata.vue:233")),"{}"!=JSON.stringify(o)&&void this.$http1.post("user/edit",o).then(function(e){if(n.setStorageSync("oldUser",1),i.isEditInfo){for(var t in o)i.userInfo[t]=o[t];i.modalShow("toastModal","信息修改成功"),i.$store.dispatch("changeVal",{stateKey:"userInfo",newValue:a.userInfo})}else n.redirectTo({url:"../home/index"})}).catch(function(t){console.log(e("edit-err",t," at pages\\initial\\personaldata.vue:252"))}))}})};t.default=u}).call(this,i("0de9")["default"],i("6e42")["default"])},cda5:function(e,t,i){"use strict";i.r(t);var n=i("02cc"),a=i("023e");for(var o in a)"default"!==o&&function(e){i.d(t,e,function(){return a[e]})}(o);i("5934");var r=i("2877"),s=Object(r["a"])(a["default"],n["a"],n["b"],!1,null,null,null);t["default"]=s.exports},d2c2:function(e,t,i){"use strict";(function(e){i("e1e3"),i("921b");n(i("66fd"));var t=n(i("cda5"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,i("6e42")["createPage"])}},[["d2c2","common/runtime","common/vendor"]]]);