(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/initial/personaldata"],{"023e":function(e,t,n){"use strict";n.r(t);var a=n("c8ca"),i=n.n(a);for(var o in a)"default"!==o&&function(e){n.d(t,e,function(){return a[e]})}(o);t["default"]=i.a},"19ac":function(e,t,n){},5934:function(e,t,n){"use strict";var a=n("19ac"),i=n.n(a);i.a},b56c:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement;e._self._c},i=[];n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i})},c8ca:function(e,t,n){"use strict";(function(e,a){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n("c478")),o=n("2f62");function r(e){return e&&e.__esModule?e:{default:e}}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){c(e,t,n[t])})}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l=function(){return Promise.all([n.e("common/vendor"),n.e("components/w-picker/w-picker")]).then(n.bind(null,"5222"))},u={name:"personaldata",components:{wPicker:l},mixins:[i.default],data:function(){return{isEditInfo:!1,userInfo:null,ischangeHeadimg:!1,selectList:[{label:"男",value:0},{label:"女",value:1}],mode:"date",defaultVal:[0,0,0,0,0,0,0],sex:"",pickerBirthdayInfo:{checkArr:["1990","01","01"],defaultVal:[],result:"选择生日"},pickerRegionInfo:{checkArr:["北京市","市辖区"],checkValue:["11","1101"],defaultVal:[],result:"选择地区"}}},computed:s({},(0,o.mapGetters)(["token"])),onLoad:function(e){this.isEditInfo=!(!e.type||"edit"!=e.type),this.api_UserInfo()},onReady:function(){},methods:s({},(0,o.mapMutations)(["changeVal"]),{api_UserInfo:function(){var t=this;this.$http1.post("user/info").then(function(e){e.data.province="",e.data.city="",t.userInfo=e.data,t.sex=1==e.data.sex?"男":"女",t.pickerBirthdayInfo.result=e.data.birthday?e.data.birthday:t.pickerBirthdayInfo.result,t.pickerRegionInfo.result=e.data.province&&e.data.city?e.data.province+""+e.data.city:t.pickerRegionInfo.result}).catch(function(t){console.log(e("userinfo-err",t," at pages\\initial\\personaldata.vue:123"))})},getUid:function(e){return e.substring(e.indexOf("/")+1,e.lastIndexOf("."))},chooseImage:function(){var t=this;a.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album"],success:function(n){var i=n.tempFilePaths[0];plus.zip.compressImage({src:i,dst:"_doc/"+t.getUid(i)+".jpg",overwrite:!0,quality:20},function(n){a.uploadFile({url:"https://api.meetu.letwx.com/v2/sys/upload-img?token="+t.token,filePath:n.target,name:"imgfile",formData:{name:"imgfile",formData:JSON.stringify({sort:0})},success:function(e){t.userInfo.headimgurl=JSON.parse(e.data).data.imgUrl,t.ischangeHeadimg=!0},fail:function(t){console.log(e("err",t," at pages\\initial\\personaldata.vue:160"))}})},function(t){console.log(e("plus-error",t," at pages\\initial\\personaldata.vue:165"))})}})},togglePicker:function(e){if("selector"==e&&1==this.userInfo.isedit)return this.modalShow("toastModal","性别只能修改一次, 你已修改过"),!1;this.mode=e,this.$refs[e].show()},onConfirm:function(t){switch(console.log(e(t," at pages\\initial\\personaldata.vue:180")),this.mode){case"date":this.pickerBirthdayInfo=t;break;case"selector":this.sex=t.result;break;case"region":this.pickerRegionInfo=t;break}},submitInfo:function(t){var n=this,i=this,o={};return""==t.detail.value.nickname?(this.modalShow("toastModal","昵称不能为空"),!1):"选择生日"===this.pickerBirthdayInfo.result?(this.modalShow("toastModal","请选择你的出生日期"),!1):"选择地区"==this.pickerRegionInfo.result?(this.modalShow("toastModal","请选择地区"),!1):null!=this.pickerRegionInfo.result.match(/\w/)?(this.modalShow("toastModal","请选择地区(中文)"),!1):(t.detail.value.nickname!=this.userInfo.nickname&&""!=t.detail.value.nickname&&(o.nickname=t.detail.value.nickname),t.detail.value.invitecode&&(o.code=t.detail.value.invitecode),this.sex!=(1==this.userInfo.sex?"男":"女")&&(o.sex="男"==this.sex?1:2),this.pickerBirthdayInfo.result!=this.userInfo.birthday&&null==this.userInfo.birthday&&(o.birthday=this.pickerBirthdayInfo.result),this.pickerRegionInfo.checkArr[0]!=this.userInfo.province&&(o.province=this.pickerRegionInfo.checkArr[0]),this.pickerRegionInfo.checkArr[1]!=this.userInfo.city&&(o.city=this.pickerRegionInfo.checkArr[1]),this.ischangeHeadimg&&(o.headimgurl=this.userInfo.headimgurl),console.log(e(o," at pages\\initial\\personaldata.vue:234")),"{}"!=JSON.stringify(o)&&void this.$http1.post("user/edit",o).then(function(e){if(a.setStorageSync("oldUser",1),n.isEditInfo){for(var t in o)n.userInfo[t]=o[t];n.modalShow("toastModal","信息修改成功"),n.$store.dispatch("changeVal",{stateKey:"userInfo",newValue:i.userInfo})}else n.$store.dispatch("changeVal",{stateKey:"carryParamsInHome",newValue:"page_personaldata"}),a.redirectTo({url:"../home/index"})}).catch(function(t){console.log(e("edit-err",t," at pages\\initial\\personaldata.vue:253"))}))}})};t.default=u}).call(this,n("0de9")["default"],n("6e42")["default"])},cda5:function(e,t,n){"use strict";n.r(t);var a=n("b56c"),i=n("023e");for(var o in i)"default"!==o&&function(e){n.d(t,e,function(){return i[e]})}(o);n("5934");var r=n("2877"),s=Object(r["a"])(i["default"],a["a"],a["b"],!1,null,null,null);t["default"]=s.exports},d2c2:function(e,t,n){"use strict";(function(e){n("e1e3"),n("921b");a(n("66fd"));var t=a(n("cda5"));function a(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("6e42")["createPage"])}},[["d2c2","common/runtime","common/vendor"]]]);