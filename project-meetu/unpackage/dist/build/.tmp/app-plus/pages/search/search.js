(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/search/search"],{"03be":function(e,a,t){},"08a3":function(e,a,t){"use strict";t.r(a);var n=t("5726"),i=t.n(n);for(var o in n)"default"!==o&&function(e){t.d(a,e,function(){return n[e]})}(o);a["default"]=i.a},"3fbe":function(e,a,t){"use strict";(function(e){t("e1e3"),t("921b");n(t("66fd"));var a=n(t("a403"));function n(e){return e&&e.__esModule?e:{default:e}}e(a.default)}).call(this,t("6e42")["createPage"])},5726:function(e,a,t){"use strict";(function(e,n){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=o(t("c478"));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(){return t.e("meetu-ui/components/cu-modal").then(t.bind(null,"f079"))},c=e.createInnerAudioContext();c.autoplay=!0;var l={name:"serach",components:{cuModal:s},mixins:[i.default],data:function(){return{searchItemW:e.upx2px(74),searchItemH:e.upx2px(74),maxWNum:0,maxHNum:0,tempLeftNum:[],tempTopNum:[],modalName:"",isSearch:!0,searchValue:[],isNewSignal:!1,openItem:null,openNum:0,showActionTwo:!1,textareaValue:"",voicePlay:!1}},onLoad:function(){var a=this;c.onEnded(function(){console.log(n("播放结束"," at pages\\search\\search.vue:102")),a.voicePlay=!1});var t=e.createSelectorQuery();t.select(".search_view").boundingClientRect(function(e){a.maxWNum=e.width/a.searchItemW,a.maxHNum=e.height/a.searchItemW}).exec()},onShow:function(){console.log(n("onShow"," at pages\\search\\search.vue:116")),this.initData()},watch:{isNewSignal:function(){this.isNewSignal&&this.api_SignalReceive()}},methods:{api_SignalReceive:function(){var e=this,a=this;this.$http1.post("signal/receive",{page:a.page}).then(function(t){if(e.isSearch=!1,a.clog("搜寻结果"+a.page,t),e.randomLocationLeft(),e.randomLocationTop(),t.data&&t.data.length>0){for(var n=0;n<t.data.length;n++)t.data[n].isDisplay=!0,t.data[n].top=e.tempTopNum[n],t.data[n].left=e.tempLeftNum[n];a.searchValue=t.data,e.page+=1}else a.page=1,a.api_SignalReceive()}).catch(function(a){console.log(n(a," at pages\\search\\search.vue:158")),e.modalShow("toastModal",a.msg)})},api_SignalRefresh:function(){var e=this;console.log(n("刷星"," at pages\\search\\search.vue:164"));var a=this;this.$http1.post("signal/refresh").then(function(t){a.clog("刷新信号",t),t.data.number>=5?(e.page=1,e.isNewSignal=!0):(e.isNewSignal=!1,e.api_SignalReceive())}).catch(function(a){"300010"==a.code&&(e.modalName="dialogModal",e.dialogText=a.msg,e.dialogSureText="充值星豆")})},api_SignalNeglect:function(e){var a=this;this.$http1.post("signal/neglect",{signal_id:e}).then(function(e){a.modalName="",a.stopVoiceHandle(),a.openItem=null})},api_SignalReply:function(e,a){var t=this;this.$http1.post("signal/reply",{signal_id:e,content:a}).then(function(e){t.textareaValue="",t.modalName="",t.showActionTwo=!1,t.stopVoiceHandle(),t.openItem=null,setTimeout(function(){t.modalShow("toastModal","回复成功")},100)})},initData:function(){if(e.getStorageSync("searchInfo")){var a=JSON.parse(e.getStorageSync("searchInfo"));this.clog("存储的搜索信息",a),this.isSearch=!1,this.searchValue=a.searchValue,this.page=a.page}else this.api_SignalReceive()},saveData:function(){var a=this,t={searchValue:a.searchValue,page:a.page};e.setStorage({key:"searchInfo",data:JSON.stringify(t)})},randomLocationLeft:function(){var e=this;this.tempLeftNum=this.selectRandom(5,1,this.maxWNum-1).map(function(a){return a*e.searchItemW}),console.log(n(this.tempLeftNum," at pages\\search\\search.vue:252"))},randomLocationTop:function(){var e=this;this.tempTopNum=this.selectRandom(5,1,this.maxWNum-1).map(function(a){return a*e.searchItemH})},selectRandom:function(e,a,t){var i,o=[],s={};if(a-t>=0)return console.log(n(111," at pages\\search\\search.vue:267")),"起始值要小于末尾值";if(i=t-a==t?parseInt(t)+1:t-a,!(e>i)){while(o.length<e){var c=Math.ceil(Math.random()*i);s[c]||(s[c]=1,o.push(c))}return o}},searchChange:function(){this.tempLeftNum=[],this.tempTopNum=[],this.searchValue=[],this.isSearch=!0,this.openNum=0,this.api_SignalRefresh()},openStarHandle:function(e,a){this.modalName="Modal",this.openItem=e,this.openNum+=1,this.searchValue[a].isDisplay=!1,this.openNum,this.searchValue.length},neglectHandle:function(){this.api_SignalNeglect(this.openItem.id)},hideModal:function(){"dialogModal"==this.modalName&&(this.modalName="")},dialogConfirm:function(){this.modalName="",e.navigateTo({url:"../user/coin",animationDuration:300,animationType:"fade-in"})},playVoiceHandle:function(e){this.voicePlay?(c.pause(),this.voicePlay=!1):e&&(c.src=e,c.play(),this.voicePlay=!0)},stopVoiceHandle:function(){this.openItem&&"voice"==this.openItem.contenttype&&(c.paused||c.stop(),c.src="",this.voicePlay=!1)},actionTwoToggle:function(e){this.showActionTwo="open"==e},submitSendHandle:function(e){this.api_SignalReply(this.openItem.id,this.textareaValue)}},onHide:function(){console.log(n("----隐藏----"," at pages\\search\\search.vue:367")),this.stopVoiceHandle(),this.saveData()},onUnload:function(){this.stopVoiceHandle(),this.saveData(),console.log(n("----页面卸载----"," at pages\\search\\search.vue:377"))}};a.default=l}).call(this,t("6e42")["default"],t("0de9")["default"])},"63dc":function(e,a,t){"use strict";var n=t("03be"),i=t.n(n);i.a},a403:function(e,a,t){"use strict";t.r(a);var n=t("dad8"),i=t("08a3");for(var o in i)"default"!==o&&function(e){t.d(a,e,function(){return i[e]})}(o);t("63dc");var s=t("2877"),c=Object(s["a"])(i["default"],n["a"],n["b"],!1,null,null,null);a["default"]=c.exports},dad8:function(e,a,t){"use strict";var n=function(){var e=this,a=e.$createElement;e._self._c},i=[];t.d(a,"a",function(){return n}),t.d(a,"b",function(){return i})}},[["3fbe","common/runtime","common/vendor"]]]);